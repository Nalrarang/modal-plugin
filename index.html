<!doctype html>
<html>
<head>
    <title>Modal Test</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
</head>
<body>
    <button type="button" class="btn">Modal</button>
    <button type="button" class="btn2">Modal</button>
    <button type="button" class="btn3">Modal</button>

</body>
<script src="./node_modules/jquery/dist/jquery.min.js"></script>
<script>
    (function ($) {
        $.fn.customModal = function(options) {
            var modal = $(this);
            var body = $('body');

            if(options == 'hide') {
                alert('hide')
                return false;
            }

            var modalOptions = $.extend({
                id: 'modalContent',
                position: 'center',
                width: '800',
                height: '600',
                left: '0',
                top: '0',
                multiple: true,
                template: '',
                onInit: function() {},
                onBeforeShow: function() {},
                onAfterHide: function() {},
                show: function() {},
                hide: function() {}
            }, options);

            var _windowWidth = window.innerWidth;
            var _windowHeight = window.innerHeight;

            var left = (_windowWidth - parseInt(modalOptions.width)) / 2;
            var top = (_windowHeight - parseInt(modalOptions.height)) / 2;


            var isBgClick = $(modal).attr('data-modal-bgclick');

            var styles = {
                'position': 'absolute',
                'width': modalOptions.width,
                'height': modalOptions.height,
                'left': left,
                'top': top,                
                'background': 'white'                
            }
            var modalTemplate = '<div id="'+ modalOptions.id +'" class="modal"><div class="cs-modal">' + modalOptions.template + '</div></div>';
            body.append(modalTemplate);
            $('.modal').css({
                width: '100%',
                height: '100%',
                left: 0,
                top: 0,
                background: 'rgba(0,0,0,0.4)',
                position: 'fixed',
                display: 'none'
            })
            var modalContent = $('.cs-modal');
            modalContent.css(styles);
            
            var onBeforeShow = function() {
                var events = $._data($('#modalContent')[0], 'events');
                if(events && events['onBeforeShow']) {
                    events.onBeforeShow[events['onBeforeShow'].length-1].handler();
                } else {
                    modalOptions.onBeforeShow();                
                }
                $('.modal').show();
            }

            var onAftershow = function() {
                 console.log('b');
            }

            modal.on('click', function(evt) {
                evt.preventDefault();
                onBeforeShow();
            });

            var methods = {
                init: function() {

                },
                show : function() {
                    console.log('show');
                },
                hide : function() {
                    console.log('hide');
                },
                destroy : function() {
                    console.log('destroy');
                }
            }

            if(methods[options]) {
                methods[options];
            }
        }
    }(jQuery));

</script>


</html> 